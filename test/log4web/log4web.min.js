!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.log4web=e():t.log4web=e()}("undefined"!=typeof window?window:global,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";var o=n(0),i=n.n(o),s=1,r=Array.prototype.slice,l="*";var a=class{constructor(){this._events={}}once(t,e){return this.on(t,e,1)}on(t,e,n){return this._events=this._events||{},this._events[t]=this._events[t]||[],e&&this._events[t].push(e),e&&(e._slotId=s)&&n&&n>0&&(e._ttl=n),s++}off(t,e){if(this._events=this._events||{},t in this._events!=0){var n=typeof e;if("number"==n){for(var o=this._events[t].length-1;o>=0;o--)if(this._events[t][o]._slotId==e){this._events[t][o]._waitOff=!0,setTimeout(function(t,e){return function(){i(t,e)}}(this,t),0);break}}else if("string"==n&&"all"==e.toLowerCase()||"undefined"==n)delete this._events[t];else{if("function"!=n)throw new Error("second param must be number/function/string");for(o=this._events[t].length-1;o>=0;o--)if(this._events[t][o].toString()===e.toString()){this._events[t][o]._waitOff=!0,setTimeout(function(t,e){return()=>{i(t,e)}}(this,t),0);break}}return this}function i(t,e){for(var n=t._events[e].length-1;n>=0;n--)t._events[e][n]._waitOff&&t._events[e].splice(n,1)}}emit(t,...e){this._events=this._events||{};var n,o=!1;function i(t){for(var e=r.call(arguments,1),i=0,s=this._events[t].length;i<s;)o=!1,(n=this._events[t][i])&&!0!==n._waitOff&&n.apply(this,e),n&&Object.prototype.hasOwnProperty.call(n,"_ttl")&&--n._ttl<=0&&(o=!0)&&this._events[t].splice(i,1),o||i++}return t in this._events&&t!==l&&i.apply(this,r.call(arguments)),l in this._events&&i.apply(this,[l].concat(r.call(arguments))),this}pipe(t){var e=this;e._events=e._events||{};var n,o=!1;function i(t){var i,s=r.call(arguments,1,arguments.length-1),l=arguments[arguments.length-1],a=0,f=e._events.hasOwnProperty(t)?e._events[t].length:0;function u(){n&&Object.prototype.hasOwnProperty.call(n,"_ttl")&&--n._ttl<=0&&(o=!0)&&e._events[t].splice(a,1),o&&f--||a++,c.apply(e,r.call(arguments))}function c(){i=r.call(arguments),o=!1,a<f?(n=e._events[t][a],0===i.length&&(i=r.call(s)),i.push(u),n.apply(e,i)):l&&l(i)}c()}var s=t===l?[l].concat(r.call(arguments)):r.call(arguments);return i.apply(e,s.concat([function(n){t!==l&&(0===n.length?n=s:n.unshift(t),n.push(null),l in e._events&&i.apply(e,[l].concat(n)))}])),e}};var f=class{constructor(t){i()(this,"_defaultConfigs",void 0),i()(this,"_nowConfigs",void 0),this._defaultConfigs=this._nowConfigs=t}resetToDefault(){this._nowConfigs=this._defaultConfigs}getConfigs(t){return t?JSON.parse(JSON.stringify(this._nowConfigs)):this._nowConfigs}setConfigs(t){if(t)for(var e in this._nowConfigs)t.hasOwnProperty(e)&&(this._nowConfigs[e]=t[e]);return this.getConfigs()}setIfNotExist(t){if(t)for(var e in t)this._nowConfigs.hasOwnProperty(e)||(this._nowConfigs[e]=t[e]);return this.getConfigs()}addConfigs(t){var e=JSON.stringify(this._nowConfigs);e=JSON.parse(e);var n=this;return t&&(!function o(i){for(var s in i)t.hasOwnProperty(s)?("object"==typeof t[s]?i[s]={...i[s],...t[s]}:i[s]=t[s],n._nowConfigs=e,delete t[s]):"object"==typeof i[s]&&o(i[s])}(e),this.setIfNotExist(t)),console.log("oldConfig",e),this.getConfigs()}tryMerge(t){var e=this.getConfigs();if(t)for(var n in this._nowConfigs)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}};n.d(e,"c",function(){return h}),n.d(e,"b",function(){return u}),n.d(e,"a",function(){return c});const u={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,FATAL:6},c={FORMAT:"format",PERSISTENCE:"persistence",FANOUT:"fanout",CONFIG_CHANGE:"configChange"};class h extends a{constructor(t){super(),i()(this,"count",1),i()(this,"configs",new f({enable:!0,level:u.TRACE})),i()(this,"plugins",[]),i()(this,"lastExeption",void 0),this.configs.addConfigs(t);let e=this;for(var n in u)e[n.toLowerCase()]=function(t){return function(...n){e.log(t,void 0,...n)}}(u[n]),e[n.toLowerCase()+"T"]=function(t){return function(n,...o){e.log(t,n,...o)}}(u[n])}catch(t){void 0!==this.lastExeption&&t&&t(this.lastExeption)}try(t){this.lastExeption=void 0;try{t()}catch(t){this.lastExeption=t,this.error(t)}return this}extend(t,e,n){if(void 0!==this[t]&&!n)throw new Exception(`method:${t} is exist!Can not be extend!`);this[t]=e}use(t){let e=t.defaultConfig?t.defaultConfig():void 0;this.configs.setIfNotExist(e);let n=new t(this.configs.getConfigs(!0),this);for(var o in this.plugins.push(n),c){let t=c[o],e=`${t}Handler`;n[e]&&this.on(t,n[e].bind(n))}return n}config(t){let e=this.configs.getConfigs(!0);this.configs.addConfigs(t),this.emit(c.CONFIG_CHANGE,e,this.configs.getConfigs(!0))}log(t,e,...n){let o=this.configs.getConfigs(!0);if(o.enable&&t>=o.level){let i={configs:o,raw:{tags:e||[],t:new Date,logIndex:this.count++,level:t,params:n},formatted:void 0};this.pipe(c.FORMAT,i),this.pipe(c.PERSISTENCE,i),this.pipe(c.FANOUT,i)}}}},function(t,e,n){"use strict";(function(t){n(1);e.a=class{constructor(t,e){}static defaultConfig(){return{defaultFanner:{enable:!0,use:""}}}fanoutHandler(e,n){let{t:o,logIndex:i,level:s,params:r,tags:l}=e.raw,{formatted:a,configs:f}=e,u=f.defaultFanner;if(u.enable){let e="undefined"!=typeof window?window:t;"console"==u.use?e.console.log(a):"alert"==u.use?e.alert(a):e&&e.console?e.console.log(a):e&&e.alert&&e.alert(a)}n()}}}).call(this,n(3))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e);var o=n(1);var i=class{constructor(t,e){}static defaultConfig(){return{defaultFormatter:{enable:!0}}}formatHandler(t,e){let{t:n,logIndex:o,level:i,params:s,tags:r}=t.raw,{formatted:l,configs:a}=t;a.defaultFormatter.enable&&(t.formatted=function t(e){let n=[];if(e&&e.length>0)for(var o=0;o<e.length;o++){let i=e[o];"number"==typeof i?n.push(i):"object"==typeof i&&i.constructor===Array?n.push(t(i)):"function"==typeof i?n.push(i.toString()):n.push(i)}return n}(s)),e()}},s=n(2),r=n(0),l=n.n(r);var a=class{constructor(t,e){l()(this,"logStore",void 0),l()(this,"defaultDispatcherNum",200),l()(this,"parent",void 0),this.logStore=[],this.parent=e,e.extend("queryLog",this.queryLog.bind(this),!0),e.extend("deleteLog",this.deleteLog.bind(this),!0)}queryLog(t,e){"function"==typeof t&&(e=t,t={}),t=void 0===t?{}:t;let{minLevel:n,tags:o,filter:i}=t,s=t=>!0,r=t=>!0;return i=void 0==i?t=>!0:i,void 0!==n&&(s=(t=>t.raw.level>=n)),void 0!==o&&o.length>0&&(r=(t=>{let e=!0;return o.forEach(n=>{t.raw.tags.includes(n)||(e=!1)}),e})),e&&e(this.logStore.filter(t=>s(t)&&r(t)&&i(t))),this}deleteLog(t,e){"function"==typeof t&&(e=t,t={});let n=[];t=void 0===t?{}:t;let{minLevel:o,tags:i,filter:s}=t,r=t=>!0,l=t=>!0;s=void 0==s?t=>!0:s,void 0!==o&&(r=(t=>t.raw.level>=o)),void 0!==i&&i.length>0&&(l=(t=>{let e=!0;return i.forEach(n=>{t.raw.tags.includes(n)||(e=!1)}),e}));let a=t=>r(t)&&l(t)&&s(t);for(var f=this.logStore.length-1;f>=0;f--)a(this.logStore[f])&&(n=n.concat(this.logStore.splice(f,1)));return e&&e(n),this}static defaultConfig(){return{defaultStore:{enable:!1,capacity:1e3}}}persistenceHandler(t,e){let{t:n,logIndex:o,level:i,params:s,tags:r}=t.raw,{formatted:l,configs:a}=t,f=a.defaultStore;if(f.enable&&this.logStore.push({raw:t.raw,formatted:t.formatted}),this.logStore.length>f.capacity){let t=this.logStore.length-f.capacity;this.logStore.splice(0,t)}e()}};function f(t){let e=new o.c(t);return e.use(i),e.use(s.a),e.use(a),e}n.d(e,"newLogger",function(){return f}),n.d(e,"LifeCycle",function(){return o.a}),n.d(e,"LogLevel",function(){return o.b})}])});
//# sourceMappingURL=log4web.min.js.map